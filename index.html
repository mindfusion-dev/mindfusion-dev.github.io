<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Выбирай стиль изображения...</title>
</head>
<body>
    <div class="container">
        <div class="ai">
            <button class="btn-ai">
                <img class="pick1" id="pick1" src="img/1.gif" value="A solo portrait of a person as a fighter from the Z Fighters anime">
                <h1>Япония</h1>
            </button>
        </div>
        <div class="ai">
            <button class="btn-ai">
                <img class="pick2" id="pick2" src="img/2.gif" value="A solo portrait of a person as a pirate, standing on a ship, pirate ships in the background">
                <h1>Пираты</h1>
            </button>   
        </div>
        <div class="ai">
            <button class="btn-ai">
                <img class="pick4" id="pick4" src="img/4.gif" value="A solo portrait of a goth gothic person, black and white comic style">
                <h1>Готика</h1>
            </button>  
        </div>
        <div class="ai">
        <button class="btn-ai">
            <img class="pick4" id="pick7" src="img/cyberp.gif" value="A solo portrait of a person as a character in the Cyberpunk 2077 universe, wearing futuristic elements, flying">
            <h1>Киберпанк</h1>
        </button>  
        </div>
        <div class="ai">
        <button class="btn-ai">
            <img class="pick2" id="pick9" src="img/elf.gif" value="A solo portrait of a person as a royal figure from Lord of the Rings, adorned in royal regalia">
            <h1>Властелин колец</h1>
        </button>  
        </div>
        <div class="ai">
        <button class="btn-ai">
            <img class="pick1" id="pick17" src="img/avatar.gif" value="A solo portrait of a person as a character from the Avatar movie, blue skin and alien like">
            <h1>Аватар</h1>
        </button>  
        </div>
    <div class="ai">
        <button class="btn-ai">
            <img class="pick3" id="pick3" src="img/3.gif" value="A solo portrait of a person as a character from Spirited Away anime">
            <h1>Унисенные призраками</h1>
        </button>
    </div>
    <div class="ai">
        <button class="btn-ai">
            <img class="pick4" id="pick14" src="img/vampire killer.gif" value="A solo portrait of a person as a vampire hunter, Vampire Hunter D anime stlye">
            <h1>Убийца Вампиров</h1>
        </button>  
    </div>
    <div class="ai">
        <button class="btn-ai">
            <img class="pick1" id="pick16" src="img/naruto.gif" value="A solo portrait of a person as a ninja, Naruto anime style">
            <h1>Наруто</h1>
        </button>
    </div>
    <div class="ai">
        <button class="btn-ai">
            <img class="pick1" id="pick27" src="img/eg.gif" value="A solo portrait of a person as a rich Egyptian pharaoh, ancient pyramids in the background">
            <h1>Древний Египет</h1>
        </button>   
    </div>
    <div class="ai">
        <button class="btn-ai">
            <img class="pick1" id="pick33" src="img/ws.gif" value="A solo portrait of a person as a cowboy in the Wild West, wearing a cowboy hat, standing next to a horse, desert around">
            <h1>Ковбой</h1>
        </button>   
    </div>
    <div class="ai">
        <button class="btn-ai">
            <img class="pick3" id="pick25" src="img/Marvel.gif" value="A solo portrait of a person as a superhero, Marvel Comics style">
            <h1>Супергерой</h1>
        </button>  
    </div>             
</div>
            <script src="https://telegram.org/js/telegram-web-app.js"></script>
            <script>
                function sendRequest(userId, value) {
                    let xhr = new XMLHttpRequest();
                    url = 'https://oneai.ru:8080/user-pick?user_id=' + userId + '&value=' + encodeURIComponent(value);
                    xhr.open('GET', url, true);
                    xhr.onload = () => {
                        setTimeout(function() {
                            tg.close();
                          }, 1300);
                      };
                    xhr.send(null);
                    console.log(xhr.status)
                    console.log(url)
                    console.log('sent')
                }

                function sendRequestMB(userId, userName) {
                    let xhr = new XMLHttpRequest();
                    url = 'https://oneai.ru:8080/loaded-event?user_id=' + userId + '&userName=' + encodeURIComponent(userName);
                    xhr.open('GET', url, true);
                    xhr.onload = () => {
                        setTimeout(function() {
                            tg.close();
                          }, 1300);
                      };
                    xhr.send(null);
                    console.log(xhr.status)
                    console.log(url)
                    console.log('sentMB')
                }

                let tg = window.Telegram.WebApp;
                userId = tg.initDataUnsafe.user.id;
                userName = tg.initDataUnsafe.user.username;
                tg.expand();
                sendRequestMB(userId, userName);
                setTimeout(function() {
                    sendRequestMB(userId, userName);
                  }, 1300);

                let pick1 = document.getElementById("pick1");
                let pick2 = document.getElementById("pick2");
                let pick3 = document.getElementById("pick3");
                let pick4 = document.getElementById("pick4");
                let pick7 = document.getElementById("pick7");
                let pick9 = document.getElementById("pick9");
                let pick14 = document.getElementById("pick14");
                let pick16 = document.getElementById("pick16");
                let pick17 = document.getElementById("pick17");
                let pick25 = document.getElementById("pick25");
                let pick27 = document.getElementById("pick27");
                let pick33 = document.getElementById("pick33");

                pick1.addEventListener("click", () => {
                    console.log(pick1.getAttribute('value'));
                    sendRequest(userId, pick1.getAttribute('value'));
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick2.addEventListener("click", () => {
                    console.log(pick2.getAttribute('value'))
                    sendRequest(userId, pick2.getAttribute('value'));
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick3.addEventListener("click", () => {
                    console.log(pick3.getAttribute('value'));
                    sendRequest(userId, pick3.getAttribute('value'));
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick4.addEventListener("click", () => {
                    console.log(pick4.getAttribute('value'));
                    sendRequest(userId, pick4.getAttribute('value'));
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick7.addEventListener("click", () => {
                    console.log(pick7.getAttribute('value'));
                    sendRequest(userId, pick7.getAttribute('value'));
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick9.addEventListener("click", () => {
                    console.log(pick9.getAttribute('value'));
                    sendRequest(userId, pick9.getAttribute('value'));
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick14.addEventListener("click", () => {
                    console.log(pick14.getAttribute('value'));
                    sendRequest(userId, pick14.getAttribute('value'));                    
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick16.addEventListener("click", () => {
                    console.log(pick16.getAttribute('value'));
                    sendRequest(userId, pick16.getAttribute('value'));                    
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick17.addEventListener("click", () => {
                    console.log(pick17.getAttribute('value'));
                    sendRequest(userId, pick17.getAttribute('value'));                   
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick25.addEventListener("click", () => {
                    console.log(pick25.getAttribute('value'));
                    sendRequest(userId, pick25.getAttribute('value'));                   
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick27.addEventListener("click", () => {
                    console.log(pick27.getAttribute('value'));
                    sendRequest(userId, pick27.getAttribute('value'));                   
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
                pick33.addEventListener("click", () => {
                    console.log(pick33.getAttribute('value'));
                    sendRequest(userId, pick33.getAttribute('value'));                   
                    setTimeout(function() {
                        tg.close();
                      }, 1300);
                });
            </script>
    </div>
</body>
</html>